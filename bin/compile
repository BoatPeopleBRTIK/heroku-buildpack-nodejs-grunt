#!/usr/bin/env bash

set -e            # fail fast
set -o pipefail   # don't ignore exit codes when piping output
# set -x          # enable debugging

# preserve git directory, which is in /app/repo.git
# GIT_DIR is '.', otherwise it would be good to join'em
export APPLICATION_GIT_DIR=`pwd`

# Configure directories
build_dir=$1
cache_dir=$2
bp_dir=$(cd $(dirname $0); cd ..; pwd)

# Load some convenience functions like status(), echo(), and indent()
source $bp_dir/bin/common.sh

status "$(git rev-parse --verify HEAD)"
